DROP TABLE REVIEW_LIKE;
DROP TABLE RATING_STAR;
DROP TABLE RATING_FACE;
DROP TABLE USER_GENRES;
DROP TABLE USER_POSTER;


DROP TABLE MBOARD;
DROP TABLE BCOMMENTS;
DROP TABLE FAQ;
DROP TABLE NOTICE;

DROP TABLE USER_HIDDEN_MOVIE;
DROP TABLE USER_POSTER;
DROP TABLE REVIEW;
DROP TABLE USERS;
DROP TABLE MOVIE;

DROP TABLE GENRES;

CREATE TABLE USERS(
USER_ID VARCHAR2(40) PRIMARY KEY,
USER_PASS VARCHAR2(40),
USER_EMAIL VARCHAR2(30),
USER_JOIN_DATE DATE,
USER_PHONE VARCHAR2(30),
USER_TYPE CHAR(1) CHECK (USER_TYPE IN('y', 'n')) 
);

CREATE TABLE USER_POSTER(
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
USER_POSTER VARCHAR2(150)
);

CREATE TABLE GENRES(
GENRES_ID NUMBER PRIMARY KEY, /*장르 ID*/
GENRES_NAME VARCHAR2(30) /*장르 이름*/
);

select * from (select rownum rnum, b.*  from 
(select * from mboard  order by BOARD_RE_REF desc, BOARD_RE_SEQ asc) b) 
where rnum>=1 and rnum<=10;

CREATE TABLE MOVIE(
MOVIE_ID NUMBER PRIMARY KEY,
MOVIE_NAME VARCHAR2(150),
MOVIE_POSTER VARCHAR2(150)
);


CREATE TABLE MBOARD(
	BOARD_NUM NUMBER(5),
	BOARD_NAME VARCHAR2(30), 
	BOARD_PASS VARCHAR2(30), 
	BOARD_SUBJECT VARCHAR2(300), 
	BOARD_CONTENT VARCHAR2(4000), 
	BOARD_FILE VARCHAR2(50),
	BOARD_RE_REF NUMBER(5), 
	BOARD_RE_LEV NUMBER(5), 
	BOARD_RE_SEQ NUMBER(5), 
	BOARD_READCOUNT NUMBER(5), 
	BOARD_DATE DATE, 
	PRIMARY KEY(BOARD_NUM)
);



CREATE TABLE review(
REVIEW_NUMBER NUMBER UNIQUE,
MOVIE_ID NUMBER REFERENCES MOVIE (MOVIE_ID) on delete cascade,
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
REVIEW_TITLE VARCHAR2(100),
REVIEW_CONTENT VARCHAR2(1000),
REVIEW_DATE DATE,
CONSTRAINT review_primarykey PRIMARY KEY (MOVIE_ID, USER_ID)
);


CREATE TABLE USER_HIDDEN_MOVIE(
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
MOVIE_ID NUMBER REFERENCES MOVIE (MOVIE_ID) on delete cascade,
CONSTRAINT USER_HIDDEN_MOVIE_primarykey PRIMARY KEY (USER_ID, MOVIE_ID)
);


CREATE TABLE NOTICE(
NOTICE_NUMBER NUMBER PRIMARY KEY,
NOTICE_NAME VARCHAR2(40) REFERENCES  USERS (USER_ID) on delete cascade,
NOTICE_SUBJECT VARCHAR2(100),
NOTICE_CONTENT VARCHAR2(300),
NOTICE_DATE DATE
);	
INSERT INTO NOTICE VALUES((select nvl(max(NOTICE_NUMBER),0) FROM NOTICE)+1, 'admin1','긴급 서버 점검','서버 안정화를 위해 금일 저녁 6시부터 서버 점검이 있을 예정입니다.
작업 예상 시간은 12월 8일 오후 6시 부터 12월 8일 오후 10시까지 입니다.
이용에 불편을 드려 죄송합니다.
더 좋은 서비스를 위해 노력하겠습니다.
',sysdate);
INSERT INTO NOTICE VALUES((select nvl(max(NOTICE_NUMBER),0) FROM NOTICE)+1, 'admin1','긴급 서버 점검','서버 안정화를 위해 금일 저녁 6시부터 서버 점검이 있을 예정입니다.
작업 예상 시간은 12월 9일 오후 6시 부터 12월 9일 오후 10시까지 입니다.
이용에 불편을 드려 죄송합니다.
더 좋은 서비스를 위해 노력하겠습니다.
',sysdate);
INSERT INTO NOTICE VALUES((select nvl(max(NOTICE_NUMBER),0) FROM NOTICE)+1, 'admin1','긴급 서버 점검','서버 안정화를 위해 금일 저녁 6시부터 서버 점검이 있을 예정입니다.
작업 예상 시간은 12월 10일 오후 6시 부터 12월 10일 오후 10시까지 입니다.
이용에 불편을 드려 죄송합니다.
더 좋은 서비스를 위해 노력하겠습니다.
',sysdate);

CREATE TABLE FAQ(
FAQ_NUMBER NUMBER PRIMARY KEY,
FAQ_NAME VARCHAR2(40) REFERENCES  USERS (USER_ID) on delete cascade,
FAQ_SUBJECT VARCHAR2(100),
FAQ_CONTENT VARCHAR2(300),
FAQ_DATE DATE
);	
INSERT INTO FAQ VALUES((select nvl(max(FAQ_NUMBER),0) FROM FAQ)+1, 'admin1','추천, 마이페이지가 보이지 않아요','로그인 상태인지 확인해 주세요.
해당 페이지는 로그인 상태에서만 확인이 가능합니다.',sysdate);
INSERT INTO FAQ VALUES((select nvl(max(FAQ_NUMBER),0) FROM FAQ)+1, 'admin1','페이지가 보이지 않아요','해당 페이지 주소를 공지사항 페이지 안에 있는 고객문의 탭에서 관리자에게 문의메일로 보내주세요.',sysdate);
INSERT INTO FAQ VALUES((select nvl(max(FAQ_NUMBER),0) FROM FAQ)+1, 'admin1','로그인이 되지 않아요','해당 계정 정보를 공지사항 페이지 안에 있는 고객문의 탭에서 관리자에게 문의메일로 보내주세요.',sysdate);
INSERT INTO FAQ VALUES((select nvl(max(FAQ_NUMBER),0) FROM FAQ)+1, 'admin1','추천 페이지의 유저매칭란이 보이지 않아요','유저매칭 추천 정보는 영화에 대한 호불호 정보가 있어야지만 표출될 수 있습니다.
하나 이상의 리뷰를 작성하여 호불호 정보를 만들어 주세요.',sysdate);
INSERT INTO FAQ VALUES((select nvl(max(FAQ_NUMBER),0) FROM FAQ)+1, 'admin1','리뷰는 어떻게 쓰나요?',
'1) 상세보기 페이지 실행
2) 리뷰쓰기 버튼 클릭
3) 얼굴 점수(호/불호) 선택 및 영화 점수 별점 표시
4) 영화에 대한 리뷰 작성
',sysdate);


CREATE TABLE BCOMMENTS (
num number primary key,
id varchar2(30) references USERS(USER_ID) on delete cascade,
content varchar2(200),
reg_date date,
BOARD_RE_REF number references mboard(BOARD_NUM) 
on delete cascade
);

create sequence comm_seq;




CREATE TABLE USER_GENRES(
GENRES_ID NUMBER REFERENCES GENRES (GENRES_ID) on delete cascade,
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
 CONSTRAINT USER_GENRES_primarykey PRIMARY KEY (GENRES_ID, USER_ID)
);



CREATE TABLE RATING_FACE(
MOVIE_ID NUMBER REFERENCES MOVIE (MOVIE_ID) on delete cascade, 
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade, 
RATING_FACE_value NUMBER CHECK (RATING_FACE_value IN(1,2)),
RATING_FACE_DATE DATE,
 CONSTRAINT RATING_FACE_primarykey PRIMARY KEY (MOVIE_ID, USER_ID)
);



CREATE TABLE RATING_STAR(
MOVIE_ID NUMBER REFERENCES MOVIE (MOVIE_ID) on delete cascade,
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
RATING_STAR_value NUMBER CHECK (RATING_STAR_value IN(1,2,3,4,5)),
RATING_STAR_DATE DATE,
CONSTRAINT RATING_STAR_primarykey PRIMARY KEY (MOVIE_ID, USER_ID)
);


CREATE TABLE REVIEW_LIKE(
MOVIE_ID NUMBER REFERENCES MOVIE (MOVIE_ID) on delete cascade,
USER_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
LIKE_ID VARCHAR2(40) REFERENCES USERS (USER_ID) on delete cascade,
CONSTRAINT REVIEW_LIKE_primarykey PRIMARY KEY (MOVIE_ID, USER_ID,LIKE_ID)
);



INSERT INTO USERS VALUES('admin1','1234','admin1@voshu.com',sysdate,'','y');
INSERT INTO USERS VALUES('admin2','1234','admin2@voshu.com',sysdate,null,'y');
INSERT INTO USERS VALUES('admin3','1234','admin3@voshu.com',sysdate,null,'y');
INSERT INTO USERS VALUES('admin4','1234','admin4@voshu.com',sysdate,null,'y');

INSERT INTO USERS VALUES('kim1234','1234','asdjkl13@naver.com',sysdate,null,'n');
INSERT INTO USERS VALUES('plain64','1234','asdjkl13@naver.com',sysdate,null,'n');
INSERT INTO USERS VALUES('duswl13','1234','plain64@naver.com',sysdate,null,'n');
INSERT INTO USERS VALUES('sonyeonsoo','1234','sonyeonsoo@naver.com',sysdate,null,'n');
INSERT INTO USERS VALUES('jiyeon','1234','jiyeon@naver.com',sysdate,null,'n');



INSERT INTO GENRES VALUES(12,'모험');
INSERT INTO GENRES VALUES(28,'액션');
INSERT INTO GENRES VALUES(16,'애니메이션');
INSERT INTO GENRES VALUES(35,'코미디');
INSERT INTO GENRES VALUES(80,'범죄');
INSERT INTO GENRES VALUES(99,'다큐멘터리');
INSERT INTO GENRES VALUES(18,'드라마');
INSERT INTO GENRES VALUES(10751,'가족');
INSERT INTO GENRES VALUES(14,'판타지');
INSERT INTO GENRES VALUES(36,'역사');
INSERT INTO GENRES VALUES(27,'공포');
INSERT INTO GENRES VALUES(10402,'음악');
INSERT INTO GENRES VALUES(9648,'미스터리');
INSERT INTO GENRES VALUES(10749,'로맨스');
INSERT INTO GENRES VALUES(878,'SF');
INSERT INTO GENRES VALUES(10770,'TV 영화');
INSERT INTO GENRES VALUES(53,'스릴러');
INSERT INTO GENRES VALUES(10752,'전쟁');
INSERT INTO GENRES VALUES(37,'서부');	

INSERT INTO MOVIE VALUES(522938,'람보: 라스트 워','/5f1hwyCxTjOUnrT23n6skqQeUD9.jpg');
INSERT INTO MOVIE VALUES(11969,'Tombstone','/xYVtxxQjY0ZT80mMu9kyz4A9QR6.jpg');
INSERT INTO MOVIE VALUES(33,'Unforgiven','/tlJuznSuaX4XsRsZ7l7RTHYAwEr.jpg');
INSERT INTO MOVIE VALUES(398978,'아이리시맨','/Ch4DTlESeylOs7VaTI5YWI2XN9.jpg');
INSERT INTO MOVIE VALUES(43949,'Flipped','/rufIMvXhFDREzby1B4s0hHc8Kmr.jpg');
INSERT INTO MOVIE VALUES(475557,'조커','/wrCwH6WOvXQvVuqcKNUrLDCDxdw.jpg');
INSERT INTO MOVIE VALUES(330457,'겨울왕국 2','/lVcwSnzhSMWYXUQzyMilCztSE6I.jpg');
INSERT INTO MOVIE VALUES(420818,'라이온 킹','/qlBePshN1ujPwm27JzT6bP6XVeR.jpg');
INSERT INTO MOVIE VALUES(420817,'알라딘','/cELHkolvQLCDGXiuZLJ2XzvynCt.jpg');
INSERT INTO MOVIE VALUES(420809,'말레피센트 2','/btpvGjqLBHgRnobKGlzbBD4jzmf.jpg');
INSERT INTO MOVIE VALUES(269149,'주토피아','/swDwD4rkXpaXUgztAbfwf7lP4e.jpg');
INSERT INTO MOVIE VALUES(299536,'어벤져스: 인피니티 워','/kmP6viwzcEkZeoi1LaVcQemcvZh.jpg');
INSERT INTO MOVIE VALUES(102651,'말레피센트','/e1XEV04HrfSSrE82dUZDy1c3Aq5.jpg');




INSERT INTO RATING_FACE VALUES(330457,'duswl13',1,sysdate);
INSERT INTO RATING_FACE VALUES(330457,'sonyeonsoo',1,sysdate);
INSERT INTO RATING_FACE VALUES(330457,'jiyeon',1,sysdate);

INSERT INTO RATING_FACE VALUES(330457,'admin1',1,sysdate);
INSERT INTO RATING_FACE VALUES(330457,'admin2',1,sysdate);

INSERT INTO RATING_FACE VALUES(420817,'duswl13',1,sysdate);
INSERT INTO RATING_FACE VALUES(420817,'sonyeonsoo',1,sysdate);
INSERT INTO RATING_FACE VALUES(420817,'jiyeon',1,sysdate);

INSERT INTO RATING_FACE VALUES(420817,'admin1',1,sysdate);
INSERT INTO RATING_FACE VALUES(420817,'admin2',1,sysdate);



INSERT INTO RATING_STAR VALUES(330457,'duswl13',3,sysdate);
INSERT INTO RATING_STAR VALUES(330457,'sonyeonsoo',4,sysdate);
INSERT INTO RATING_STAR VALUES(330457,'jiyeon',3,sysdate);

INSERT INTO RATING_STAR VALUES(330457,'admin1',4,sysdate);
INSERT INTO RATING_STAR VALUES(330457,'admin2',5,sysdate);




INSERT INTO RATING_STAR VALUES(420817,'duswl13',5,sysdate);
INSERT INTO RATING_STAR VALUES(420817,'sonyeonsoo',5,sysdate);
INSERT INTO RATING_STAR VALUES(420817,'jiyeon',4,sysdate);

INSERT INTO RATING_STAR VALUES(420817,'admin1',4,sysdate);
INSERT INTO RATING_STAR VALUES(420817,'admin2',3,sysdate);




INSERT INTO RATING_FACE VALUES(269149,'duswl13',1,sysdate);
INSERT INTO RATING_FACE VALUES(269149,'sonyeonsoo',1,sysdate);
INSERT INTO RATING_FACE VALUES(269149,'jiyeon',1,sysdate);

INSERT INTO RATING_FACE VALUES(269149,'admin1',2,sysdate);
INSERT INTO RATING_FACE VALUES(269149,'admin2',2,sysdate);

INSERT INTO RATING_STAR VALUES(269149,'duswl13',5,sysdate);
INSERT INTO RATING_STAR VALUES(269149,'sonyeonsoo',4,sysdate);
INSERT INTO RATING_STAR VALUES(269149,'jiyeon',4,sysdate);

INSERT INTO RATING_STAR VALUES(269149,'admin1',2,sysdate);
INSERT INTO RATING_STAR VALUES(269149,'admin2',3,sysdate);


INSERT INTO RATING_FACE VALUES(299536,'duswl13',1,sysdate);
INSERT INTO RATING_FACE VALUES(299536,'sonyeonsoo',1,sysdate);
INSERT INTO RATING_FACE VALUES(299536,'admin1',1,sysdate);
INSERT INTO RATING_FACE VALUES(299536,'admin2',1,sysdate);

INSERT INTO RATING_STAR VALUES(299536,'admin1',5,sysdate);
INSERT INTO RATING_STAR VALUES(299536,'admin2',5,sysdate);
INSERT INTO RATING_STAR VALUES(299536,'sonyeonsoo',3,sysdate);
INSERT INTO RATING_STAR VALUES(299536,'duswl13',4,sysdate);



INSERT INTO RATING_FACE VALUES(420809,'duswl13',1,sysdate);
INSERT INTO RATING_STAR VALUES(420809,'duswl13',4,sysdate);


