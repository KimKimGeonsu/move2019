<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Chu">
<select id="ChMain"  resultType="c">
select * from USER_GENRES where USER_ID = #{id}
</select>
<select id="matching" resultType="String">
SELECT user_id , count (*) c
    FROM (select * from rating_face where RATING_FACE_value=1) r1 
 WHERE MOVIE_ID in 
(select  MOVIE_ID from rating_face where user_id=#{id} and RATING_FACE_value=1) 
<![CDATA[ 
and r1.user_id <> #{id} 
]]>
 GROUP BY user_id
 order by c desc
</select>

<select id="Chmachings"  resultType="d">
select movie_id from(select * from RATING_FACE where user_id=#{id} 
order by DBMS_RANDOM.RANDOM)where rownum <![CDATA[< 6]]>
</select>
</mapper> 
